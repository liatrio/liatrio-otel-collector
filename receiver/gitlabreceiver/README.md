# GitLab Receiver

<!-- status autogenerated section -->
| Status        |           |
| ------------- |-----------|
| Stability     | [development]: metrics   |
| Distributions | [liatrio] |
| Issues        | [![Open issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aopen%20label%3Areceiver%2Fgitlab%20&label=open&color=orange&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aopen+is%3Aissue+label%3Areceiver%2Fgitlab) [![Closed issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aclosed%20label%3Areceiver%2Fgitlab%20&label=closed&color=blue&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aclosed+is%3Aissue+label%3Areceiver%2Fgitlab) |

[development]: https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/component-stability.md#development
[liatrio]: 
<!-- end autogenerated section -->

The GitLab receiver receives data from [GitLab](https://gitlab.com/). As a
starting point it scrapes metrics from projects but will be extended to
include traces and logs.

The current default set of metrics can be found in
[documentation.md](./documentation.md).

These metrics can be used as leading indicators ([capabilities][doracap])
to the [DORA][dorafour] metrics; helping provide insight into modern-day
engineering practices.

[doracap]: https://dora.dev/capabilities/
[dorafour]: https://dora.dev/guides/dora-metrics-four-keys/

## Getting Started

The collection interval is common to all scrapers and is set to 30 seconds by default.

> Note: Generally speaking, if the vendor allows for anonymous API calls, then you
> won't have to configure any authentication, but you may only see public repositories
> and organizations. You may run into significantly more rate limiting.

```yaml
gitlab:
    initial_delay: <duration>
    collection_interval: <duration> #default = 30s recommended 300s
    scrapers:
        gitlab:
        ...
```

A more complete example using the GitLab scrapers with authentication is as follows:

```yaml
extensions:
    bearertokenauth/gitlab:
        token: ${env:GL_PAT}

receivers:
    gitlab:
        initial_delay: 1s
        collection_interval: 60s
        scrapers:
            gitlab:
                metrics:
                    vcs.repository.contributor.count:
                        enabled: true
                gitlab_org: myfancyorg
                search_query: "org:myfancyorg topic:o11yalltheway" #Recommended optional query override, defaults to "{org,user}:<gitlab_org>"
                limit_merge_requests: 30 #Limit querying merged MRs to the last 30 days, defaults to querying all historical merged MRs
                endpoint: "https://selfmanagedenterpriseserver.com"
                auth:
                    authenticator: bearertokenauth/gitlab
service:
    extensions: [bearertokenauth/gitlab]
    pipelines:
        metrics:
            receivers: [..., gitlab]
            processors: []
            exporters: [...]
```

A Grafana Dashboard exists on the marketplace for metrics from this receiver
and can be found
[here](https://grafana.com/grafana/dashboards/20976-engineering-effectiveness-metrics/).

## Scraping

> Important:
> * The GitLab scraper does not emit metrics for refs that have not had
>   changes since creation from the default ref (trunk).
> * Due to GitHub API limitations, it is possible for the ref time metric to
>   change when rebases occur, recreating the commits with new timestamps.


<!-- TODO: Combine this documentation once the scraper code is restructured due scope change -->
